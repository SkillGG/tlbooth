// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("DB_URL")
    directUrl = env("DB_DIRECT_URL")
}

enum LANG {
    PL
    EN
    JP
}

enum ChapterStatus {
    STAGED
    TL
    PR
    PUBLISH
}

enum LineStatus {
    STAGED
    TL
    PR
}

model Translation {
    id String @id @default(cuid())

    oglang LANG
    tllang LANG

    Chapter   Chapter? @relation(fields: [chapterID], references: [id])
    chapterID String?  @map("chapterId")

    lines TextLine[]
}

model TextLine {
    id String @id @default(cuid()) @map("_id")

    pos    Int
    tlline String
    ogline String

    status LineStatus @default(STAGED)

    fullText Translation @relation(fields: [textID], references: [id], onDelete: Cascade)
    textID   String      @map("textId")
}

model Novel {
    id String @id @default(cuid()) @map("_id")

    url String @unique

    ogname String
    tlname String @default("")

    ogdesc String @default("")
    tldesc String @default("")

    chapters Chapter[]
}

model Chapter {
    id String @id @default(cuid()) @map("_id")

    url String @unique

    num String @default("1")

    status ChapterStatus

    ogname String
    tlname String?

    Novel   Novel  @relation(fields: [novelID], references: [id], onDelete: Cascade)
    novelID String @map("novelId")

    translations Translation[]
}
